<% if(posts.length === null || posts.length === 0){ %>
  <meta http-equiv="refresh" content="0; URL='/notfound'" />
<% } else { %>
<!DOCTYPE html>
<html>
<head>
    <title>All Catches - fishingBakersfield</title>
<% include partials/header %>
<% include partials/loginbar %>
<div class="container">
<% include partials/message %>
<a class="button" href="/locations/<%= posts[0].catchlocationid %>"><i class="fa fa-arrow-left">&nbsp;</i>All Locations</a>
<br>
<br>
      <div class="box">
	<div class="content">
	<p style="font-size: 20px"><i class="fa fa-rss">&nbsp;</i>All catches from <%= posts[0].catchlocation %>:</p>
	<hr>
	</div>
		<p>
	    <a class="button is-success" href="/locations/<%= posts[0].catchlocationid %>/catch/new"><i class="fa fa-plus">&nbsp;</i>Add Catch</a>
            <span style="float: right; font-size: 12px">Sorted By: <i class="fa fa-clock-o">&nbsp;</i>Most Recent</span>
		</p>
	<br>
        <div class="masonry">
            <% for (var i = 0; i < posts.length; i++) { %>
  		<div class="item">
		<div class="card">
  <div class="card-header">
        <figure class="image">
      <img src="<%= posts[i].image %>" alt="<%= posts[i].species %>">
      </figure>

  </div>
  <div class="card-content">
    <div class="media">
      <div class="media-content">
        <p class="title is-4"><i class="fa fa-user">&nbsp;</i><%= posts[i].author.username %></p>
        <p class="subtitle is-6"><i class="fa fa-map-signs">&nbsp;</i><%= posts[i].catchlocation %></p>
      </div>
    </div>

    <div class="content">
      <%= posts[i].description %>
      <br>
      <time><i class="fa fa-calendar">&nbsp;</i><%= posts[i].createdAt.toDateString() %></time><br>
	                                                            <% if(currentUser && posts[i].author.id.equals(currentUser._id) || currentUser && currentUser.isAdmin) { %>
                                                                <a class="button is-small is-warning" href="/locations/<%= posts[i].catchlocationid %>/catch/<%= posts[i]._id %>/edit">
                                                                       <i class="fa fa-pencil-square-o">&nbsp;</i>Edit
                                                                </a>
                                                                <form class="sameLine" action="/locations/<%= posts[i].catchlocationid %>/catch/<%= posts[i]._id %>?_method=DELETE" method="POST">
                                                                        <button class="button is-small is-danger">
                                                                        <i class="fa fa-trash">&nbsp;</i>Delete</button>
                                                                </form>
                                                            <% } %>
    </div>
  </div>
							<footer class="card-footer">
							<a class="card-footer-item" href="/catch/<%= posts[i]._id %>"><i class="fa fa-share">&nbsp;</i>Open</a>
							</footer>
  </div>
</div>
<br />
            <% } %>
        </div>
        </div>
 <% if (pages > 0) { %>

        <nav class="pagination" role="navigation" aria-label="pagination">
        <% if (Number(current) - 1 > 0) { %>
            <a class="pagination-previous" href="/locations/<%= post[0].catchlocationid %>/catches/<%= Number(current) - 1 %>"><i class="fa fa-arrow-circle-left">&nbsp;</i>Previous</a>
        <% } else { %>
	    <a class="pagination-previous" disabled><i class="fa fa-arrow-circle-left">&nbsp;</i>Previous</a>
	<% } %>
	<% if (Number(current) + 1 <= pages) { %>
            <a href="/locations/<%= posts[0].catchlocationid %>/catches/<%= Number(current) + 1 %>" class="pagination-next"><i class="fa fa-arrow-circle-right">&nbsp;</i>Next page</a>
        <% } else { %>
            <a class="pagination-next" disabled><i class="fa fa-arrow-circle-right">&nbsp;</i>Next page</a>
	<% } %>
            <ul class="pagination-list">
            <% var i = (Number(current) > 3 ? Number(current) - 2 : 1) %>
            <% if (current == 1) { %>
              			<li>
                			<a class="pagination-link" disabled>First</a>
              			</li>
            		<% } else { %>
              			<li>
                			<a class="pagination-link" href="/locations/<%= posts[0].catchlocationid %>/catches/1">First</a>
              			</li>
	    		<% } %>
            <% for (; i <= (Number(current) + 2) && i <= pages; i++) { %>
                <% if (i == current) { %>
                     <li>
                         <a class="pagination-link is-current"><%= i %></a>
                     </li>
                <% } else { %>
		     <li>
			 <a class="pagination-link" href="/locations/<%= posts[0].catchlocationid %>/catches/<%= i %>"><%= i %></a>
		     </li>
		<% } %>
		<% } %>
            		<% if (current == pages) { %>
				<li>
		    			<a class="pagination-link" disabled>Last</a>
				</li>
            		<% } else { %>
				<li>
		    			<a href="/locations/<%= posts[0].catchlocationid %>/catches/<%= pages %>" class="pagination-link">Last</a>
				</li>
            		<% } %>
            </ul>
          </nav>

<% } %>
</div>
<% include partials/footer %>
<% } %>
